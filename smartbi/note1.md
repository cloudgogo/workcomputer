## SMARTBI使用

#### 安装
**系统环境要求**
1. 环境:windows下64位操作系统
2. windows下安装(知识库为mysql服务器,可在安装过程中注册为系统服务,在开始菜单中将多一个后台控制器)
3. 插件安装,下载插件点击安装即可,office插件支持office2010/2013/2016

**安装过程**
1. 官网下载安装包(推荐使用百度云下载,可以找到插件及历史版本*link*:[下载链接](https://pan.baidu.com/s/1skBn4Hv#list/path=%2F))
2. 点击安装    
![安装](img/img1.jpg)
3. 注意项: 安装过程直接下一步即可,输入公司名等信息随意,无限制,检查知识库端口(其实是检查mysql端口)通过后点击下一步,可以点击注册为windows服务,将会生成后台服务管理器,点击安装

#### 启动
1. 在开始菜单中找到`smartbi Insight` 进入目录点击启动应用服务器(实际是执行tomcat的startup.bat批处理文件),进行启动.
2. 等待执行完成后,点击访问`smartbi`,弹出添加授权文件的页面,这里我们先与客服沟通并获取到了对应的零时licence:`smartbi-license.xml`将其依照提示添加或直接将文件添加到tomcat的bin目录下
3. 添加licence后,再次进行访问,我们就进入了smartbi的登录界面,初次登录admin使用的是默认密码`manager`,进入后提示我们修改密码    
![修改密码](img/img2.jpg)
> 系统界面
![系统界面](img/img3.jpg)

#### 自助分析
既然是bi产品,那就是面向业务人员的产品,业务人员分析时如何使用产品就是该部分的内容
1. **创建关系数据源**,我们的数据大都是基于数据库的,而进行自助分析的前提是搭建好数据模型,数据模型的搭建首先需要让我们的应用知道从哪儿取数,所以第一步是创建关系数据源    
![创建关系数据源](img/img4.png)    
填写驱动信息及数据库信息,测试连接并保存    
![填写信息](img/img5.jpg)      
管理数据库中的数据内容及关系    
![数据库管理](img/img6.jpg)     
添加需要构建关系管理的表    
![添加表到应用中](img/img7.png)    
查看添加的表,进行表的注释,便于表关系视图的梳理    
![查看添加的表](img/img8.png)    
![添加表注释](img/img9.png)    
新建表关系视图,保存表与表间关系    
![表关系视图建立的位置](img/img10.png)    
建立表关系视图    
![建立表关系视图](img/img11.png)    
![修改表间关系](img/img12.png)
2. **创建业务主题**    
业务主题是为了在对应的业务逻辑中添加所需用到的由表抽象出来的对象所创建的集合
反手键点击数据管理下的业务主题,弹出菜单点击新建,我们就可以进行新建业务主题    
![新建业务主题](img/img16.png)     
新建业务主题后我们将在业务主题下看到我们新建的业务主题,双击打开编辑    
![业务主题编辑](img/img15.png)    
对业务对象属性的修改    
![业务对象属性修改](img/img17.png)    
对业务对象对象属性的增加    
![业务对象属性增加](img/img18.png)    
对业务对象对象属性的属性的增加及修改     
![业务对象对象属性的属性的增加及修改](img/img19.png)   
![业务对象对象属性的属性的增加及修改](img/img20.png)   
3. **创建组合分析**    
建立好业务主题后,我们就可以基于业务主题进行分析(也可以基于数据源进行主题分析,很不灵活)     
组合分析是清单式的,一行表头罗列数据的,通过组合各种列进行展示
![创建组合分析](img/img14.png)    
![创建组合分析](img/img21.png)    
进行组合分析    
![组合分析](img/img22.png)     
效果
![组合分析](img/img23.png)    
添加图型
![添加图型](img/img24.png)

4. **创建透视分析**    
以上组合分析主要是用于查询数据结果,相对固定,无法上钻下钻,接下来的透视分析则与之不同,可以用于交叉报表并可进行数据间的穿透    
![创建透视分析](img/img25.png)    
步骤与组合分析类似    
![选择待选列进行透视分析](img/img26.png)    
添加小计    
![添加小计](img/img27.png)    
添加筛选条件    
![添加筛选条件](img/img28.png)    

5. **保存**
![保存](img/img29.png)    


#### 电子表格
电子表格是使用excel插件进行表单的定制化开发,有点类似于帆软的设计器    
1. **下载excel的smartbi插件**    
通过百度云盘即可下得如下插件,我们将使用excel插件来进行电子表格的开发    
![smartbi插件](img/img30.png)    
2. **安装**    
运行.exe文件直接下一步就可以
3. **启动excel配置环境**
![excel电子表格](img/img31.png)
4. **数据源配置**    
同自助分析
5. **表关系定义**    
同自助分析
6. **创建业务查询**    
由于我们是通过excel进行表单的开发,故我们需要对表间关系进行业务关联,而创建业务查询就是为了这一目标而存在的,我试验过不进行创建直接使用多表,最后出现了笛卡尔积问题    
![创建业务查询](img/img32.png)    
业务查询
![业务查询](img/img33.png)    
通过以上操作我们就可以开始excel的定制开发了    
7. **excel开发**    
我们现在回到excel,并登录到smartbi的服务器,在右侧的数据集面版中找到我们定义好的业务查询(如果没有找到数据集面板,请点击左上角服务器区块的视图)    
![excel开发](img/img34.png)    
样式及单元格填充    
![样式及单元格填充](img/img35.png)     
预览效果    
![预览效果](img/img36.png)    
执行效果
![执行效果](img/img37.png)    




